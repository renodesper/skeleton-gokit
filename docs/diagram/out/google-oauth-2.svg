<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="727px" preserveAspectRatio="none" style="width:625px;height:727px;background:#F9F9F9;" version="1.1" viewBox="0 0 625 727" width="625px" zoomAndPan="magnify"><defs/><g><rect fill="#F9F9F9" height="313.0156" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="478.5" x="10" y="82.7988"/><rect fill="#F9F9F9" height="266.3945" style="stroke:none;stroke-width:1.0;" width="478.5" x="10" y="129.4199"/><rect fill="#F9F9F9" height="178.8184" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="458.5" x="20" y="209.9961"/><rect fill="#F9F9F9" height="102.8867" style="stroke:none;stroke-width:1.0;" width="458.5" x="20" y="285.9277"/><rect fill="#F9F9F9" height="75.9316" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="228" x="391.5" y="468.4355"/><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="57" x2="57" y1="36.4883" y2="691.6094"/><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="248.5" x2="248.5" y1="36.4883" y2="691.6094"/><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="434.5" x2="434.5" y1="36.4883" y2="691.6094"/><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="570.5" x2="570.5" y1="36.4883" y2="691.6094"/><rect fill="#E55756" height="30.4883" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="54" x="30" y="5"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="37" y="25.5352">Client</text><rect fill="#E55756" height="30.4883" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="54" x="30" y="690.6094"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="37" y="711.1445">Client</text><rect fill="#E55756" height="30.4883" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="63" x="217.5" y="5"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="224.5" y="25.5352">Google</text><rect fill="#E55756" height="30.4883" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="63" x="217.5" y="690.6094"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="224.5" y="711.1445">Google</text><rect fill="#E55756" height="30.4883" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="67" x="401.5" y="5"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="408.5" y="25.5352">UserSvc</text><rect fill="#E55756" height="30.4883" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="67" x="401.5" y="690.6094"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="408.5" y="711.1445">UserSvc</text><rect fill="#E55756" height="30.4883" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="77" x="532.5" y="5"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="539.5" y="25.5352">Database</text><rect fill="#E55756" height="30.4883" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="77" x="532.5" y="690.6094"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="539.5" y="711.1445">Database</text><polygon fill="#191919" points="237,63.7988,247,67.7988,237,71.7988,241,67.7988" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;" x1="57" x2="243" y1="67.7988" y2="67.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="64" y="63.0566">Login via Google Oauth url</text><path d="M13.5,82.7988 L72,82.7988 L72,89.7988 L62,99.7988 L10,99.7988 L10,86.2988 " fill="#EEEEEE" style="stroke:#393939;stroke-width:1.0;"/><rect fill="none" height="313.0156" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="478.5" x="10" y="82.7988"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="96.3672">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="68" x="87" y="95.4336">[failed case]</text><polygon fill="#191919" points="68,117.4199,58,121.4199,68,125.4199,64,121.4199" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;" x1="62" x2="248" y1="121.4199" y2="121.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="74" y="116.6777">Unauthorized</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="488.5" y1="130.4199" y2="130.4199"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79" x="15" y="141.0547">[success case]</text><polygon fill="#191919" points="423,161.6855,433,165.6855,423,169.6855,427,165.6855" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="249" x2="429" y1="165.6855" y2="165.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="256" y="160.9434">Send Google Oauth Code</text><polygon fill="#191919" points="260,190.9961,250,194.9961,260,198.9961,256,194.9961" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="254" x2="434" y1="194.9961" y2="194.9961"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="266" y="190.2539">Verify Google Oauth Code</text><path d="M23.5,209.9961 L82,209.9961 L82,216.9961 L72,226.9961 L20,226.9961 L20,213.4961 " fill="#EEEEEE" style="stroke:#393939;stroke-width:1.0;"/><rect fill="none" height="178.8184" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="458.5" x="20" y="209.9961"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="35" y="223.5645">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="102" x="97" y="222.6309">[not verified case]</text><polygon fill="#191919" points="423,244.6172,433,248.6172,423,252.6172,427,248.6172" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;" x1="249" x2="429" y1="248.6172" y2="248.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="256" y="243.875">Unauthorized</text><polygon fill="#191919" points="68,273.9277,58,277.9277,68,281.9277,64,277.9277" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;" x1="62" x2="434" y1="277.9277" y2="277.9277"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="74" y="273.1855">Unauthorized</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="478.5" y1="286.9277" y2="286.9277"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="80" x="25" y="297.5625">[verified case]</text><polygon fill="#191919" points="423,318.1934,433,322.1934,423,326.1934,427,322.1934" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="249" x2="429" y1="322.1934" y2="322.1934"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="256" y="317.4512">Authorized</text><polygon fill="#191919" points="260,347.5039,250,351.5039,260,355.5039,256,351.5039" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="254" x2="434" y1="351.5039" y2="351.5039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="266" y="346.7617">Request user data</text><polygon fill="#191919" points="423,376.8145,433,380.8145,423,384.8145,427,380.8145" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="249" x2="429" y1="380.8145" y2="380.8145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="256" y="376.0723">User data</text><polygon fill="#191919" points="559,420.125,569,424.125,559,428.125,563,424.125" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="435" x2="565" y1="424.125" y2="424.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="442" y="419.3828">Get user by email</text><polygon fill="#191919" points="446,449.4355,436,453.4355,446,457.4355,442,453.4355" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440" x2="570" y1="453.4355" y2="453.4355"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="452" y="448.6934">User data</text><path d="M395,468.4355 L453.5,468.4355 L453.5,475.4355 L443.5,485.4355 L391.5,485.4355 L391.5,471.9355 " fill="#EEEEEE" style="stroke:#393939;stroke-width:1.0;"/><rect fill="none" height="75.9316" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="228" x="391.5" y="468.4355"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="406.5" y="482.0039">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="91" x="468.5" y="481.0703">[not found case]</text><polygon fill="#191919" points="559,503.0566,569,507.0566,559,511.0566,563,507.0566" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;" x1="435" x2="565" y1="507.0566" y2="507.0566"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="442" y="502.3145">Register user</text><polygon fill="#191919" points="446,532.3672,436,536.3672,446,540.3672,442,536.3672" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440" x2="570" y1="536.3672" y2="536.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="452" y="531.625">User data</text><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="435" x2="477" y1="572.6777" y2="572.6777"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="477" x2="477" y1="572.6777" y2="585.6777"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="436" x2="477" y1="585.6777" y2="585.6777"/><polygon fill="#191919" points="446,581.6777,436,585.6777,446,589.6777,442,585.6777" style="stroke:#191919;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="442" y="567.9355">Generate JWT token</text><polygon fill="#191919" points="559,610.9883,569,614.9883,559,618.9883,563,614.9883" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="435" x2="565" y1="614.9883" y2="614.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="442" y="610.2461">Store JWT token</text><polygon fill="#191919" points="446,640.2988,436,644.2988,446,648.2988,442,644.2988" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440" x2="570" y1="644.2988" y2="644.2988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="452" y="639.5566">User data</text><polygon fill="#191919" points="68,669.6094,58,673.6094,68,677.6094,64,673.6094" style="stroke:#191919;stroke-width:1.0;"/><line style="stroke:#191919;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="62" x2="434" y1="673.6094" y2="673.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="74" y="668.8672">JWT token (access &amp; refresh tokens)</text><!--MD5=[15ef9a39bc2726183e70d9d8b49d1cd5]
@startuml
!include https://raw.githubusercontent.com/renodesper/puml-themes/master/themes/puml-theme-mars.puml

Client -> Google: Login via Google Oauth url

alt failed case
  Google -> Client: Unauthorized
else success case
  Google - -> UserSvc: Send Google Oauth Code
  UserSvc - -> Google: Verify Google Oauth Code

  alt not verified case
    Google -> UserSvc: Unauthorized
    UserSvc -> Client: Unauthorized
  else verified case
    Google - -> UserSvc: Authorized
    UserSvc - -> Google: Request user data
    Google - -> UserSvc: User data
  end
end

UserSvc - -> Database: Get user by email
Database - -> UserSvc: User data

alt not found case
  UserSvc -> Database: Register user
  Database - -> UserSvc: User data
end

UserSvc - -> UserSvc: Generate JWT token
UserSvc - -> Database: Store JWT token
Database - -> UserSvc: User data
UserSvc - -> Client: JWT token (access & refresh tokens)
@enduml

@startuml
skinparam BackgroundColor F9F9F9
skinparam shadowing false
skinparam RoundCorner 7
skinparam ArrowColor 191919
skinparam FontColor 191919
skinparam SequenceLifeLineBorderColor 393939
skinparam SequenceGroupHeaderFontColor 191919
skinparam SequenceGroupFontColor 393939
skinparam SequenceGroupBorderColor 393939
skinparam SequenceGroupBorderThickness 1

skinparam sequenceDivider {
    BorderColor 191919
    BorderThickness 1
    FontColor 191919
}

skinparam participant {
    BackgroundColor E55756
    BorderColor 191919
    FontColor F9F9F9
    BorderThickness 1.5
}

skinparam database {
    BackgroundColor A4DBD8
    BorderColor 191919
    FontColor 191919
}

skinparam entity {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam note {
    BackgroundColor e5e5e5
    BorderColor 191919
    FontColor 191919
    BorderThickness 1.5
}

skinparam actor {
    BackgroundColor 191919
    BorderColor 191919
    FontColor 191919
}

skinparam boundary {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam control {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam collections {
    BackgroundColor E55756
    BorderColor 191919
    FontColor 191919
    BorderThickness 1.5
}

skinparam queue {
    BackgroundColor E55756
    BorderColor 191919
    FontColor FFF
    BorderThickness 1.5
}

Client -> Google: Login via Google Oauth url

alt failed case
  Google -> Client: Unauthorized
else success case
  Google - -> UserSvc: Send Google Oauth Code
  UserSvc - -> Google: Verify Google Oauth Code

  alt not verified case
    Google -> UserSvc: Unauthorized
    UserSvc -> Client: Unauthorized
  else verified case
    Google - -> UserSvc: Authorized
    UserSvc - -> Google: Request user data
    Google - -> UserSvc: User data
  end
end

UserSvc - -> Database: Get user by email
Database - -> UserSvc: User data

alt not found case
  UserSvc -> Database: Register user
  Database - -> UserSvc: User data
end

UserSvc - -> UserSvc: Generate JWT token
UserSvc - -> Database: Store JWT token
Database - -> UserSvc: User data
UserSvc - -> Client: JWT token (access & refresh tokens)
@enduml

PlantUML version 1.2021.7(Sun May 23 19:40:07 WIB 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: ID
--></g></svg>